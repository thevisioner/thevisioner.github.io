var mesh=function(){function B(c){d&&C.removeChild(d.element);switch(c){case "webgl":d=v;break;case "canvas":d=w;break;case "svg":d=I}d.setSize(h.offsetWidth,h.offsetHeight);C.appendChild(d.element)}function p(){g.remove(x);d.clear();k=new FSS.Plane(e.width*d.width,e.height*d.height,e.segments,e.slices);D=new FSS.Material(e.ambient,e.diffuse);x=new FSS.Mesh(k,D);g.add(x);var c,a;for(c=k.vertices.length-1;0<=c;c--)a=k.vertices[c],a.anchor=FSS.Vector3.clone(a.position),a.step=FSS.Vector3.create(Math.randomInRange(.2,
1),Math.randomInRange(.2,1),Math.randomInRange(.2,1)),a.time=Math.randomInRange(0,Math.PIM2)}function E(){var c,a;for(c=g.lights.length-1;0<=c;c--)a=g.lights[c],g.remove(a);d.clear();for(c=0;c<f.count;c++)a=new FSS.Light(f.ambient,f.diffuse),a.ambientHex=a.ambient.format(),a.diffuseHex=a.diffuse.format(),g.add(a),a.mass=Math.randomInRange(.5,1),a.velocity=FSS.Vector3.create(),a.acceleration=FSS.Vector3.create(),a.force=FSS.Vector3.create(),a.ring=document.createElementNS(FSS.SVGNS,"circle"),a.ring.setAttributeNS(null,
"stroke",a.ambientHex),a.ring.setAttributeNS(null,"stroke-width","0.5"),a.ring.setAttributeNS(null,"fill","none"),a.ring.setAttributeNS(null,"r","10"),a.core=document.createElementNS(FSS.SVGNS,"circle"),a.core.setAttributeNS(null,"fill",a.diffuseHex),a.core.setAttributeNS(null,"r","4")}function F(c,a){y=768<c?-140:-105;e.segments=c/105>>0;e.slices=a/118>>0;d.setSize(c,a);FSS.Vector3.set(t,d.halfWidth,d.halfHeight);p()}function z(){q=Date.now()-J;var c,a,d,b,l,h=e.depth/2;FSS.Vector3.copy(f.bounds,
t);FSS.Vector3.multiplyScalar(f.bounds,f.xyScalar);FSS.Vector3.setZ(m,f.zOffset);f.autopilot&&(c=Math.sin(f.step[0]*q*f.speed),a=Math.cos(f.step[1]*q*f.speed),FSS.Vector3.set(m,f.bounds[0]*c,f.bounds[1]*a,f.zOffset));d=FSS.Vector3.create();for(c=g.lights.length-1;0<=c;c--)a=g.lights[c],FSS.Vector3.setZ(a.position,f.zOffset),b=Math.clamp(FSS.Vector3.distanceSquared(a.position,m),f.minDistance,f.maxDistance),b=f.gravity*a.mass/b,FSS.Vector3.subtractVectors(a.force,m,a.position),FSS.Vector3.normalise(a.force),
FSS.Vector3.multiplyScalar(a.force,b),FSS.Vector3.set(a.acceleration),FSS.Vector3.add(a.acceleration,a.force),FSS.Vector3.add(a.velocity,a.acceleration),FSS.Vector3.multiplyScalar(a.velocity,f.dampening),FSS.Vector3.limit(a.velocity,f.minLimit,f.maxLimit),FSS.Vector3.add(a.position,a.velocity),FSS.Vector3.add(d,a.position);FSS.Vector3.divideScalar(d,g.lights.length);FSS.Vector3.divide(d,f.bounds);FSS.Vector3.clamp(d,-1,1);K.style.margin=y+16*d[1]+"px 0 0 "+(y-16*d[0])+"px";for(b=k.vertices.length-
1;0<=b;b--)l=k.vertices[b],c=Math.sin(l.time+l.step[0]*q*e.speed),a=Math.cos(l.time+l.step[1]*q*e.speed),d=Math.sin(l.time+l.step[2]*q*e.speed),FSS.Vector3.set(l.position,e.xRange*k.segmentWidth*c,e.yRange*k.sliceHeight*a,e.zRange*h*d-h),FSS.Vector3.add(l.position,l.anchor);k.dirty=!0;G();u&&requestAnimationFrame(z)}function G(){d.render(g);if(f.draw){var c,a,e,b;for(c=g.lights.length-1;0<=c;c--)switch(b=g.lights[c],a=b.position[0],e=b.position[1],r.renderer){case "canvas":d.context.lineWidth=.5;
d.context.beginPath();d.context.arc(a,e,10,0,Math.PIM2);d.context.strokeStyle=b.ambientHex;d.context.stroke();d.context.beginPath();d.context.arc(a,e,4,0,Math.PIM2);d.context.fillStyle=b.diffuseHex;d.context.fill();break;case "svg":a+=d.halfWidth,e=d.halfHeight-e,b.core.setAttributeNS(null,"fill",b.diffuseHex),b.core.setAttributeNS(null,"cx",a),b.core.setAttributeNS(null,"cy",e),d.element.appendChild(b.core),b.ring.setAttributeNS(null,"stroke",b.ambientHex),b.ring.setAttributeNS(null,"cx",a),b.ring.setAttributeNS(null,
"cy",e),d.element.appendChild(b.ring)}}}function L(){var c,a,h,b;n=new dat.GUI({autoPlace:!1});A.appendChild(n.domElement);uiFolder=n.addFolder("UI");renderFolder=n.addFolder("Render");meshFolder=n.addFolder("Mesh");lightFolder=n.addFolder("Light");exportFolder=n.addFolder("Export");uiFolder.open();renderFolder.open();lightFolder.open();b=uiFolder.add(M,"show");b.onChange(function(a){N.className=a?"wrapper":"wrapper hide"});b=renderFolder.add(r,"renderer",{webgl:"webgl",canvas:"canvas",svg:"svg"});
b.onChange(function(a){B(a)});b=meshFolder.addColor(e,"ambient");b.onChange(function(b){c=0;for(a=g.meshes.length;c<a;c++)g.meshes[c].material.ambient.set(b)});b=meshFolder.addColor(e,"diffuse");b.onChange(function(b){c=0;for(a=g.meshes.length;c<a;c++)g.meshes[c].material.diffuse.set(b)});b=meshFolder.add(e,"width",.05,2);b.onChange(function(a){k.width!==a*d.width&&p()});b=meshFolder.add(e,"height",.05,2);b.onChange(function(a){k.height!==a*d.height&&p()});b=meshFolder.add(e,"depth",0,50);b=meshFolder.add(e,
"segments",1,20);b.step(1);b.onChange(function(a){k.segments!==a&&p()});b=meshFolder.add(e,"slices",1,20);b.step(1);b.onChange(function(a){k.slices!==a&&p()});b=meshFolder.add(e,"xRange",0,1);b=meshFolder.add(e,"yRange",0,1);b=meshFolder.add(e,"speed",0,.01);H=lightFolder.add(f,"autopilot");b=lightFolder.addColor(f,"ambient");b.onChange(function(b){c=0;for(a=g.lights.length;c<a;c++)h=g.lights[c],h.ambient.set(b),h.ambientHex=h.ambient.format()});b=lightFolder.addColor(f,"diffuse");b.onChange(function(b){c=
0;for(a=g.lights.length;c<a;c++)h=g.lights[c],h.diffuse.set(b),h.diffuseHex=h.diffuse.format()});b=lightFolder.add(f,"count",0,5);b.step(1);b.onChange(function(a){g.lights.length!==a&&E()});b=lightFolder.add(f,"zOffset",0,500);b.step(1)}var K=document.getElementById("logo-shadow"),y=-140,e={width:1.2,height:1.2,depth:10,segments:window.innerWidth/105>>0,slices:window.innerHeight/118>>0,xRange:.8,yRange:.1,zRange:1,ambient:"#616466",diffuse:"#C3C3C3",speed:.002},f={count:2,xyScalar:1,zOffset:100,ambient:"#13182A",
diffuse:"#727272",speed:.001,gravity:1200,dampening:.95,minLimit:10,maxLimit:null,minDistance:20,maxDistance:400,autopilot:!0,draw:!1,bounds:FSS.Vector3.create(),step:FSS.Vector3.create(Math.randomInRange(.2,1),Math.randomInRange(.2,1),Math.randomInRange(.2,1))},r={renderer:"canvas"},M={show:!0},u=!0,q,J=Date.now(),t=FSS.Vector3.create(),m=FSS.Vector3.create(),h=document.getElementById("container"),A=document.getElementById("controls"),C=document.getElementById("output"),N=document.getElementById("ui"),
d,g,x,k,D,v,w,I,n,H;w=new FSS.CanvasRenderer;r.renderer=window.WebGLRenderingContext||w.element.getContext("webgl")?"webgl":"canvas";"webgl"===r.renderer&&(v=new FSS.WebGLRenderer);v.unsupported&&(r.renderer="canvas");B(r.renderer);g=new FSS.Scene;p();E();window.addEventListener("resize",function(c){F(h.offsetWidth,h.offsetHeight);G()});h.addEventListener("click",function(c){FSS.Vector3.set(m,c.x,d.height-c.y);FSS.Vector3.subtract(m,t);f.autopilot=!f.autopilot;A&&H.updateDisplay()});h.addEventListener("mousemove",
function(c){FSS.Vector3.set(m,c.x,d.height-c.y);FSS.Vector3.subtract(m,t)});A&&L();F(h.offsetWidth,h.offsetHeight);z();document.getElementById("vignette").className+=" vignette";document.getElementById("noise").className+=" noise";return{animate:function(c){!u&&c?(u=c,z()):u=c}}}();